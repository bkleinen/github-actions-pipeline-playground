name: Complex Pipeline

on:
  push:
    branches:
      - main
      - alpha
      - beta

jobs:
  build-backend:
    name: Backend Build
    runs-on: ubuntu-latest
    steps:
     - name: run the script
       run: pipeline/dosomething.sh 1
  build-frontend:
    name: Frontend Build
    runs-on: ubuntu-latest
    steps:
     - name: run the script
       run: pipeline/dosomething.sh 1
  test-backend:
    needs:
      - build-backend
    name: Backend Build
    runs-on: ubuntu-latest
    steps:
     - name: run the script
       run: pipeline/dosomething.sh 1
  test-frontend:
    needs:
      - build-frontend
    name: Frontend Build
    uses: ./.github/workflows/development.yml
  qa-test:
    name: QA Test - Detached
    runs-on: ubuntu-latest
    steps:
     - name: run the script
       run: pipeline/dosomething.sh 1 qa-fails
  integration-test:
    needs:
      - test-frontend
      - test-backend
    name: Integration Test
    runs-on: ubuntu-latest
    steps:
     - name: run the script
       run: pipeline/dosomething.sh 1
  deploy-staging:
    needs:
      - integration-test
    name: Deploy Staging
    runs-on: ubuntu-latest
    steps:
     - name: run the script
       run: pipeline/dosomething.sh 1
  deploy-production:
    needs:
      - deploy-staging
    name: Deploy Production
    runs-on: ubuntu-latest
    steps:
     - name: run the script
       run: pipeline/dosomething.sh 1
